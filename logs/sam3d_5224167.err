  0%|          | 0/60 [00:00<?, ?it/s]/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
  2%|▏         | 1/60 [00:08<08:50,  8.99s/it]  3%|▎         | 2/60 [00:09<03:48,  3.93s/it]  5%|▌         | 3/60 [00:09<02:10,  2.30s/it]  7%|▋         | 4/60 [00:10<01:25,  1.53s/it]  8%|▊         | 5/60 [00:13<01:57,  2.13s/it] 10%|█         | 6/60 [00:13<01:25,  1.58s/it] 12%|█▏        | 7/60 [00:14<01:11,  1.34s/it] 13%|█▎        | 8/60 [00:14<00:53,  1.02s/it] 15%|█▌        | 9/60 [00:18<01:36,  1.89s/it] 17%|█▋        | 10/60 [00:19<01:11,  1.42s/it] 18%|█▊        | 11/60 [00:20<01:03,  1.30s/it] 20%|██        | 12/60 [00:20<00:48,  1.01s/it] 22%|██▏       | 13/60 [00:24<01:29,  1.90s/it] 23%|██▎       | 14/60 [00:24<01:06,  1.44s/it] 25%|██▌       | 15/60 [00:25<00:53,  1.19s/it] 27%|██▋       | 16/60 [00:27<00:57,  1.30s/it] 28%|██▊       | 17/60 [00:31<01:31,  2.13s/it] 30%|███       | 18/60 [00:31<01:07,  1.60s/it] 32%|███▏      | 19/60 [00:31<00:50,  1.22s/it] 33%|███▎      | 20/60 [00:32<00:38,  1.04it/s] 35%|███▌      | 21/60 [00:36<01:20,  2.05s/it] 37%|███▋      | 22/60 [00:37<00:58,  1.54s/it] 38%|███▊      | 23/60 [00:37<00:43,  1.19s/it] 40%|████      | 24/60 [00:37<00:33,  1.06it/s] 42%|████▏     | 25/60 [00:43<01:20,  2.30s/it] 43%|████▎     | 26/60 [00:43<00:58,  1.71s/it] 45%|████▌     | 27/60 [00:43<00:43,  1.31s/it] 47%|████▋     | 28/60 [00:44<00:32,  1.03s/it] 48%|████▊     | 29/60 [00:49<01:13,  2.39s/it] 50%|█████     | 30/60 [00:50<00:53,  1.78s/it] 52%|█████▏    | 31/60 [00:50<00:39,  1.35s/it] 53%|█████▎    | 32/60 [00:51<00:29,  1.06s/it] 55%|█████▌    | 33/60 [00:55<00:57,  2.13s/it] 57%|█████▋    | 34/60 [00:55<00:41,  1.59s/it] 58%|█████▊    | 35/60 [00:56<00:30,  1.22s/it] 60%|██████    | 36/60 [00:56<00:23,  1.04it/s] 62%|██████▏   | 37/60 [01:01<00:51,  2.24s/it] 63%|██████▎   | 38/60 [01:02<00:36,  1.68s/it] 65%|██████▌   | 39/60 [01:02<00:27,  1.29s/it] 67%|██████▋   | 40/60 [01:03<00:20,  1.02s/it] 68%|██████▊   | 41/60 [01:08<00:47,  2.49s/it] 70%|███████   | 42/60 [01:09<00:33,  1.87s/it] 72%|███████▏  | 43/60 [01:09<00:24,  1.46s/it] 73%|███████▎  | 44/60 [01:10<00:18,  1.13s/it] 75%|███████▌  | 45/60 [01:14<00:32,  2.17s/it] 77%|███████▋  | 46/60 [01:15<00:22,  1.63s/it] 78%|███████▊  | 47/60 [01:15<00:16,  1.24s/it] 80%|████████  | 48/60 [01:15<00:11,  1.02it/s] 82%|████████▏ | 49/60 [01:21<00:24,  2.22s/it] 83%|████████▎ | 50/60 [01:21<00:16,  1.66s/it] 85%|████████▌ | 51/60 [01:21<00:11,  1.27s/it] 87%|████████▋ | 52/60 [01:22<00:07,  1.01it/s] 88%|████████▊ | 53/60 [01:27<00:15,  2.23s/it] 90%|█████████ | 54/60 [01:27<00:09,  1.66s/it] 92%|█████████▏| 55/60 [01:27<00:06,  1.26s/it] 93%|█████████▎| 56/60 [01:28<00:03,  1.02it/s] 95%|█████████▌| 57/60 [01:33<00:06,  2.23s/it] 97%|█████████▋| 58/60 [01:33<00:03,  1.71s/it] 98%|█████████▊| 59/60 [01:34<00:01,  1.30s/it]100%|██████████| 60/60 [01:34<00:00,  1.01s/it]100%|██████████| 60/60 [01:34<00:00,  1.58s/it]
Val Inference Epoch 123:   0%|          | 0/20 [00:00<?, ?it/s]Val Inference Epoch 123:   0%|          | 0/20 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 537, in <module>
    main()
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 505, in main
    trainer.train()
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 451, in train
    self.inference_on_val(epoch)
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 396, in inference_on_val
    embedding = sam_model.image_encoder(image_tensor)
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/segment_anything/modeling/image_encoder3D.py", line 148, in forward
    x = x + self.pos_embed
RuntimeError: The size of tensor a (57) must match the size of tensor b (8) at non-singleton dimension 3
