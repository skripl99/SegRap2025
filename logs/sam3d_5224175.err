  0%|          | 0/60 [00:00<?, ?it/s]/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sam3d/lib/python3.10/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
  2%|▏         | 1/60 [00:08<08:46,  8.93s/it]  3%|▎         | 2/60 [00:09<03:46,  3.90s/it]  5%|▌         | 3/60 [00:09<02:09,  2.28s/it]  7%|▋         | 4/60 [00:10<01:24,  1.52s/it]  8%|▊         | 5/60 [00:12<01:49,  1.99s/it] 10%|█         | 6/60 [00:13<01:21,  1.50s/it] 12%|█▏        | 7/60 [00:14<01:12,  1.36s/it] 13%|█▎        | 8/60 [00:14<00:55,  1.07s/it] 15%|█▌        | 9/60 [00:18<01:29,  1.76s/it] 17%|█▋        | 10/60 [00:18<01:06,  1.32s/it] 18%|█▊        | 11/60 [00:19<01:03,  1.29s/it] 20%|██        | 12/60 [00:20<00:48,  1.01s/it] 22%|██▏       | 13/60 [00:24<01:29,  1.90s/it] 23%|██▎       | 14/60 [00:24<01:08,  1.49s/it] 25%|██▌       | 15/60 [00:25<00:54,  1.21s/it] 27%|██▋       | 16/60 [00:25<00:43,  1.01it/s] 28%|██▊       | 17/60 [00:30<01:31,  2.13s/it] 30%|███       | 18/60 [00:30<01:07,  1.60s/it] 32%|███▏      | 19/60 [00:31<00:50,  1.23s/it] 33%|███▎      | 20/60 [00:31<00:38,  1.03it/s] 35%|███▌      | 21/60 [00:36<01:19,  2.03s/it] 37%|███▋      | 22/60 [00:36<00:57,  1.52s/it] 38%|███▊      | 23/60 [00:36<00:43,  1.17s/it] 40%|████      | 24/60 [00:37<00:33,  1.08it/s] 42%|████▏     | 25/60 [00:42<01:19,  2.26s/it] 43%|████▎     | 26/60 [00:42<00:57,  1.70s/it] 45%|████▌     | 27/60 [00:43<00:43,  1.31s/it] 47%|████▋     | 28/60 [00:43<00:32,  1.03s/it] 48%|████▊     | 29/60 [00:48<01:11,  2.30s/it] 50%|█████     | 30/60 [00:49<00:51,  1.72s/it] 52%|█████▏    | 31/60 [00:50<00:41,  1.45s/it] 53%|█████▎    | 32/60 [00:50<00:31,  1.12s/it] 55%|█████▌    | 33/60 [00:55<00:58,  2.18s/it] 57%|█████▋    | 34/60 [00:55<00:42,  1.63s/it] 58%|█████▊    | 35/60 [00:55<00:31,  1.25s/it] 60%|██████    | 36/60 [00:56<00:23,  1.03it/s] 62%|██████▏   | 37/60 [01:01<00:50,  2.19s/it] 63%|██████▎   | 38/60 [01:01<00:35,  1.64s/it] 65%|██████▌   | 39/60 [01:01<00:26,  1.25s/it] 67%|██████▋   | 40/60 [01:02<00:19,  1.02it/s] 68%|██████▊   | 41/60 [01:08<00:46,  2.47s/it] 70%|███████   | 42/60 [01:08<00:33,  1.84s/it] 72%|███████▏  | 43/60 [01:08<00:23,  1.40s/it] 73%|███████▎  | 44/60 [01:09<00:18,  1.14s/it] 75%|███████▌  | 45/60 [01:13<00:31,  2.11s/it] 77%|███████▋  | 46/60 [01:14<00:22,  1.58s/it] 78%|███████▊  | 47/60 [01:14<00:15,  1.22s/it] 80%|████████  | 48/60 [01:14<00:11,  1.01it/s] 82%|████████▏ | 49/60 [01:19<00:23,  2.12s/it] 83%|████████▎ | 50/60 [01:20<00:15,  1.58s/it] 85%|████████▌ | 51/60 [01:20<00:10,  1.21s/it] 87%|████████▋ | 52/60 [01:20<00:07,  1.05it/s] 88%|████████▊ | 53/60 [01:26<00:15,  2.26s/it] 90%|█████████ | 54/60 [01:26<00:10,  1.68s/it] 92%|█████████▏| 55/60 [01:26<00:06,  1.28s/it] 93%|█████████▎| 56/60 [01:27<00:04,  1.01s/it] 95%|█████████▌| 57/60 [01:32<00:06,  2.26s/it] 97%|█████████▋| 58/60 [01:32<00:03,  1.68s/it] 98%|█████████▊| 59/60 [01:32<00:01,  1.27s/it]100%|██████████| 60/60 [01:33<00:00,  1.17s/it]100%|██████████| 60/60 [01:34<00:00,  1.58s/it]
Val Inference Epoch 124:   0%|          | 0/20 [00:00<?, ?it/s]Val Inference Epoch 124:   0%|          | 0/20 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 547, in <module>
    main()
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 515, in main
    trainer.train()
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 461, in train
    self.inference_on_val(epoch)
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 408, in inference_on_val
    pred, _ = self.interaction(sam_model, embedding, dummy_gt, num_clicks=11)
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 269, in interaction
    points_input, labels_input = self.get_points(prev_masks, gt3D)
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 247, in get_points
    batch_points, batch_labels = click_methods[self.args.click_type](prev_masks, gt3D)
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/utils/click_method.py", line 209, in get_next_click3D_torch_2
    point = points[np.random.randint(len(points))]
  File "numpy/random/mtrand.pyx", line 798, in numpy.random.mtrand.RandomState.randint
  File "numpy/random/_bounded_integers.pyx", line 1334, in numpy.random._bounded_integers._rand_int64
ValueError: high <= 0
