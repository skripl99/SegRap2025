/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 24 worker processes in total. Our suggested max number of worker in current system is 16, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:29<28:40, 29.16s/it]  3%|▎         | 2/60 [00:30<12:05, 12.51s/it]  5%|▌         | 3/60 [00:30<06:48,  7.17s/it]  7%|▋         | 4/60 [00:31<04:19,  4.63s/it]  8%|▊         | 5/60 [00:32<02:57,  3.23s/it] 10%|█         | 6/60 [00:33<02:08,  2.37s/it] 12%|█▏        | 7/60 [00:33<01:37,  1.85s/it] 13%|█▎        | 8/60 [00:34<01:16,  1.47s/it] 15%|█▌        | 9/60 [00:35<01:02,  1.22s/it] 17%|█▋        | 10/60 [00:37<01:13,  1.47s/it] 18%|█▊        | 11/60 [00:38<01:03,  1.30s/it] 20%|██        | 12/60 [00:38<00:54,  1.14s/it] 22%|██▏       | 13/60 [00:39<00:48,  1.02s/it] 23%|██▎       | 14/60 [00:40<00:45,  1.00it/s] 25%|██▌       | 15/60 [00:41<00:42,  1.05it/s] 27%|██▋       | 16/60 [00:42<00:39,  1.12it/s] 28%|██▊       | 17/60 [00:43<00:39,  1.08it/s] 30%|███       | 18/60 [00:43<00:34,  1.23it/s] 32%|███▏      | 19/60 [00:44<00:34,  1.18it/s] 33%|███▎      | 20/60 [00:45<00:29,  1.34it/s] 35%|███▌      | 21/60 [00:45<00:26,  1.47it/s] 37%|███▋      | 22/60 [00:46<00:23,  1.60it/s] 38%|███▊      | 23/60 [00:46<00:21,  1.70it/s] 40%|████      | 24/60 [00:47<00:20,  1.79it/s] 42%|████▏     | 25/60 [00:47<00:18,  1.86it/s] 43%|████▎     | 26/60 [00:48<00:17,  1.94it/s] 45%|████▌     | 27/60 [00:48<00:16,  2.00it/s] 47%|████▋     | 28/60 [00:49<00:18,  1.72it/s] 48%|████▊     | 29/60 [00:49<00:16,  1.83it/s] 50%|█████     | 30/60 [00:50<00:15,  1.92it/s] 52%|█████▏    | 31/60 [00:50<00:14,  1.98it/s] 53%|█████▎    | 32/60 [00:51<00:13,  2.04it/s] 55%|█████▌    | 33/60 [00:51<00:13,  2.07it/s] 57%|█████▋    | 34/60 [00:52<00:12,  2.10it/s] 58%|█████▊    | 35/60 [00:52<00:11,  2.12it/s] 60%|██████    | 36/60 [00:53<00:11,  2.13it/s] 62%|██████▏   | 37/60 [00:53<00:12,  1.80it/s] 63%|██████▎   | 38/60 [00:54<00:11,  1.85it/s] 65%|██████▌   | 39/60 [00:54<00:10,  1.94it/s] 67%|██████▋   | 40/60 [00:55<00:10,  2.00it/s] 68%|██████▊   | 41/60 [00:55<00:09,  1.93it/s] 70%|███████   | 42/60 [00:56<00:08,  2.01it/s] 72%|███████▏  | 43/60 [00:56<00:08,  2.06it/s] 73%|███████▎  | 44/60 [00:57<00:07,  2.09it/s] 75%|███████▌  | 45/60 [00:57<00:07,  2.11it/s] 77%|███████▋  | 46/60 [00:58<00:07,  1.80it/s] 78%|███████▊  | 47/60 [00:58<00:06,  1.89it/s] 80%|████████  | 48/60 [00:59<00:06,  1.97it/s] 82%|████████▏ | 49/60 [00:59<00:05,  2.03it/s] 83%|████████▎ | 50/60 [01:00<00:04,  2.06it/s] 85%|████████▌ | 51/60 [01:00<00:04,  2.08it/s] 87%|████████▋ | 52/60 [01:01<00:03,  2.10it/s] 88%|████████▊ | 53/60 [01:01<00:03,  2.12it/s] 90%|█████████ | 54/60 [01:02<00:02,  2.14it/s] 92%|█████████▏| 55/60 [01:02<00:02,  1.80it/s] 93%|█████████▎| 56/60 [01:03<00:02,  1.89it/s] 95%|█████████▌| 57/60 [01:03<00:01,  1.97it/s] 97%|█████████▋| 58/60 [01:04<00:00,  2.03it/s] 98%|█████████▊| 59/60 [01:04<00:00,  1.91it/s]100%|██████████| 60/60 [01:05<00:00,  1.95it/s]100%|██████████| 60/60 [01:05<00:00,  1.09s/it]
/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:227: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
Traceback (most recent call last):
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 804, in <module>
    main()
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 706, in main
    trainer.train()
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 594, in train
    self.plot_result(self.dices, 'Dice', 'Dice')
  File "/dss/dsshome1/0D/ru47tac2/projects/segrap2025/SAM-Med3D/train.py", line 541, in plot_result
    plt.plot(plot_data)
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/matplotlib/pyplot.py", line 3838, in plot
    return gca().plot(
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/matplotlib/axes/_axes.py", line 1777, in plot
    lines = [*self._get_lines(self, *args, data=data, **kwargs)]
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/matplotlib/axes/_base.py", line 297, in __call__
    yield from self._plot_args(
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/matplotlib/axes/_base.py", line 486, in _plot_args
    x, y = index_of(xy[-1])
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/matplotlib/cbook.py", line 1676, in index_of
    y = _check_1d(y)
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/matplotlib/cbook.py", line 1368, in _check_1d
    return np.atleast_1d(x)
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/numpy/_core/shape_base.py", line 63, in atleast_1d
    result = asanyarray(arys[0])
  File "/dss/dsshome1/0D/ru47tac2/miniconda3/envs/sammed3d/lib/python3.10/site-packages/torch/_tensor.py", line 1194, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
